{"ast":null,"code":"export {};","map":{"version":3,"names":[],"sources":["/Users/fabian/Desktop/CSCI467-Group-Project/src/app/pocreate/pocreate.component.ts"],"sourcesContent":["import { Component, Inject, ElementRef, Renderer2, ViewChild, OnInit, createComponent } from '@angular/core';\nimport { Router, NavigationEnd,ActivatedRoute } from '@angular/router';\nimport { HttpClient } from '@angular/common/http';\nimport {\n  MatDialog,\n  MAT_DIALOG_DATA,\n  MatDialogRef,\n  MatDialogTitle,\n  MatDialogContent,\n  MatDialogActions,\n  MatDialogClose,\n} from '@angular/material/dialog';\nimport {MatButtonModule} from '@angular/material/button';\nimport {FormsModule} from '@angular/forms';\nimport {MatInputModule} from '@angular/material/input';\nimport {MatFormFieldModule} from '@angular/material/form-field';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { PopUpComponent } from '../pop-up/pop-up.component';\n\n@Component({\n  selector: 'app-pocreate',\n  templateUrl: './pocreate.component.html',\n  styleUrls: ['./pocreate.component.css']\n})\n\n@Component({\n  selector: 'app-pop-up',\n  templateUrl: './pop-up.component.html',\n  styleUrls: ['./pop-up.component.css'],\n  //standalone: true,\n//})\n\nexport class PocreateComponent {\n  responseFromPHP: any;\n  selectOptions: any[] = [];\n  selectedQuote: any = [];\n  QuoteLine: any;\n  SelectedVal: any;\n  EmpName: any;\n  savedAssoc: any;\n  quoteSelected: boolean = false;\n  //Discount and Total Amounts\n  total: any = 0.0;\n  DiscountType: any = 'P';\n  DiscountDollar: any = 0.00;\n  DiscountPercent: any = 0.00;\n  TempTotal: any = 0;\n  //Customer Information For PO View\n  Customer: any;\n  CustomerName: any;\n  CustomerContact: any;\n  CustomerAddyLn1: any;\n  CustomerAddyLn2: any;\n\n\n  constructor(private http: HttpClient, private router: Router) { }\n\n  //private dialogRef : MatDialog\n // openDialog(){\n   // this.dialogRef.open(PopUpComponent);\n  //}\n\n  ngOnInit() {\n    this.Datacheck();\n    this.http.get('https://phpapicsci467.azurewebsites.net/php_script/pocreate/selectQuote.php').subscribe((response: any) => {\n      this.selectOptions = response;\n    });\n  }\n\n  Datacheck(): void\n  {\n    //Stored Associate Name\n    var AssocName = localStorage.getItem('AssocName');\n    if(AssocName !== null){\n      this.EmpName = JSON.parse(AssocName);\n    }\n    //Stored Associate ID\n    var savedAssoc = localStorage.getItem('CurrentAssoc');\n    if(savedAssoc !== null){\n      this.savedAssoc = JSON.parse(savedAssoc);\n      console.log(savedAssoc);\n    }else{\n      this.router.navigateByUrl('/');\n      setTimeout(function(){\n        alert(\"Error: User not found, please Login\");\n      }, 200);\n    }\n  }\n\n  private quoteURL='https://phpapicsci467.azurewebsites.net/php_script/pocreate/selectQuoteLine.php';\n\n  RetriveData(QID: any) : void{\n    this.quoteSelected = true;\n    for(let i = 0; i < this.selectOptions.length; ++i)\n    {\n      if(this.selectOptions[i]['ID'] == QID)\n      {\n        this.total = this.selectOptions[i]['Total'];\n        this.selectedQuote = this.selectOptions[i];\n        this.RetriveCustInfo(this.selectOptions[i]['CustID']);\n      }\n    }\n    console.log(this.selectedQuote['ID']);\n    const quoteData={quoteID: QID}\n    this.http.post(this.quoteURL,quoteData, {responseType:'json'}).subscribe(\n      responseData=>{\n        this.QuoteLine=responseData;\n\n    });\n  }\n\n  private custURL='https://phpapicsci467.azurewebsites.net/php_script/pocreate/CustomerInfo.php';\n  RetriveCustInfo(CustID: any) : void{\n    const quoteData={custID: CustID}\n    this.http.post(this.custURL,quoteData, {responseType:'json'}).subscribe(\n      response=>{\n        this.Customer = response;\n        console.log(this.Customer);\n        this.CustomerName = this.Customer[0]['name'];\n        this.CustomerAddyLn1 = this.Customer[0]['street'];\n        this.CustomerAddyLn2 = this.Customer[0]['city'];\n        this.CustomerContact = this.Customer[0]['contact'];\n    });\n  }\n\n  count: number=2;\n\nDiscountSelect():void\n{\n  console.log(this.DiscountType);\n}\n\nChangeCounter: number = 0;\n\n//Code below is for applying discount when the button is click\nApplyDiscount():void\n{\n  if (this.ChangeCounter < 1)\n  {\n    this.TempTotal = this.total;\n  }\n  else\n  {\n    this.total = this.TempTotal;\n  }\n\n  ++this.ChangeCounter;\n\n  if(this.DiscountType == 'P')\n  {\n    console.log(\"This is %: \" + this.DiscountPercent);\n    this.total = this.total - (this.total * this.DiscountPercent);\n    if(this.total < 0){\n      this.total = this.TempTotal;\n      this.DiscountPercent = 0.0;\n    }\n  }\n  else if(this.DiscountType == 'D')\n  {\n    console.log(\"This is $: \" + this.DiscountDollar);\n    this.total = this.total - this.DiscountDollar;\n    if(this.total < 0){\n      this.DiscountDollar = 0.0;\n      this.total = this.TempTotal;\n     }\n  }\n}\nQuoteProcessUrl = \"https://phpapicsci467.azurewebsites.net/php_script/pocreate/ProcessingSystem.php\";\nSubmitFinal(): void{\n\n  const FinalQuoteData = {\n    QuoteData: this.selectedQuote,\n    NewTotal: this.total\n\n  };\n\n  this.http.post(this.QuoteProcessUrl, FinalQuoteData).subscribe({        \n    next: (data: any) => {\n    // This shows array of response\n    console.log(data);\n\n    //New Amount\n    const saleAmt: number = data['amount'];\n\n    //tempPct removes \"%\" -> Pct creates a float\n    const tempPct = data['commission'].replace('%','');\n    const Pct = parseFloat(tempPct);\n\n    //getting commission rate\n    const assocCom = saleAmt * (Pct / 100);\n\n      //array of new associate data\n    const assocData = \n    {\n      assoc: data['associate'],\n      comAmt: assocCom\n    }\n\n    this.UpdateAssoc(assocData);\n\n    },\n    error: (error) => {\n      console.error('Error Sending data', error);\n    }\n  });\n    console.log(this.selectedQuote);\n}\n\n\nUpdateAssocUrl = \"https://phpapicsci467.azurewebsites.net/php_script/pocreate/UpdateSalesAssoc.php\";\n\nUpdateAssoc(assocData:any): void\n{\n  console.log(assocData);\n\n  this.http.post(this.UpdateAssocUrl, assocData).subscribe({        \n    next: (data: any) => {\n      console.log(data);\n    },\n    error: (error) => {\n      console.error('Error Sending data', error);\n    }\n  });\n}\n\nchangeQuote():void{\n  this.quoteSelected = false;\n}\n\n}\n\n\n\n"],"mappings":"AAqOC"},"metadata":{},"sourceType":"module","externalDependencies":[]}